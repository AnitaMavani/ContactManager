{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useContext, useEffect } from 'react';\nimport axios from 'axios';\nimport { AuthContext } from '../context/AuthContext';\nimport FormManager from './FormManager';\nimport Validation from '../utils/Validation';\nimport { useNavigate } from 'react-router-dom';\nconst useAuth = ({\n  isRegister\n}) => {\n  _s();\n  const [error, setError] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const {\n    login\n  } = useContext(AuthContext);\n  const navigate = useNavigate();\n  const initialState = isRegister ? {\n    name: \"\",\n    email: \"\",\n    password: \"\",\n    confirmPassword: \"\"\n  } : {\n    email: \"\",\n    password: \"\"\n  };\n  const {\n    inputs,\n    errors,\n    handleChange,\n    validate,\n    resetForm\n  } = FormManager(initialState);\n  useEffect(() => {\n    resetForm(initialState);\n  }, [isRegister]);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setError('');\n    if (validate(Validation)) {\n      setIsLoading(true);\n      try {\n        const endpoint = isRegister ? '/register' : '/login';\n        const response = await axios.post(`http://localhost:5001/api/auth${endpoint}`, inputs);\n        console.log(isRegister ? \"Registration successful\" : \"Login successful\", response.data);\n        resetForm(initialState);\n        if (!isRegister) {\n          localStorage.setItem('token', response.data.token);\n          login(response.data.user.name);\n          navigate('/'); // Redirect to home or dashboard\n        }\n      } catch (error) {\n        var _error$response, _error$response$data;\n        setError(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || 'Something went wrong');\n        console.error('Auth error:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    } else {\n      console.log(\"Validation failed:\", errors);\n    }\n  };\n  return {\n    inputs,\n    errors,\n    handleChange,\n    isLoading,\n    error,\n    handleSubmit\n  };\n};\n_s(useAuth, \"dSvC5lk8iKudOhG+dM2vbzgz99s=\", false, function () {\n  return [useNavigate];\n});\nexport default useAuth;","map":{"version":3,"names":["useState","useContext","useEffect","axios","AuthContext","FormManager","Validation","useNavigate","useAuth","isRegister","_s","error","setError","isLoading","setIsLoading","login","navigate","initialState","name","email","password","confirmPassword","inputs","errors","handleChange","validate","resetForm","handleSubmit","e","preventDefault","endpoint","response","post","console","log","data","localStorage","setItem","token","user","_error$response","_error$response$data"],"sources":["/Users/anitamavani/workspace/React/my-ts-app/frontend/src/hooks/useAuth.tsx"],"sourcesContent":["import { useState, useContext, useEffect } from 'react';\nimport axios from 'axios';\nimport { AuthContext } from '../context/AuthContext';\nimport FormManager from './FormManager';\nimport Validation from '../utils/Validation';\nimport { useNavigate } from 'react-router-dom';\n\ntype FormState = {\n  name?: string;\n  email: string;\n  password: string;\n  confirmPassword?: string;\n};\n\ntype UseAuthProps = {\n  isRegister: boolean;\n};\n\nconst useAuth = ({ isRegister }: UseAuthProps) => {\n  const [error, setError] = useState<string>('');\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n  const { login } = useContext(AuthContext);\n  const navigate = useNavigate();\n\n  const initialState: FormState = isRegister\n    ? { name: \"\", email: \"\", password: \"\", confirmPassword: \"\" }\n    : { email: \"\", password: \"\" };\n\n  const { inputs, errors, handleChange, validate, resetForm } = FormManager(initialState);\n\n  useEffect(() => {\n    resetForm(initialState);\n  }, [isRegister]);\n\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    setError('');\n\n    if (validate(Validation)) {\n      setIsLoading(true);\n      try {\n        const endpoint = isRegister ? '/register' : '/login';\n        const response = await axios.post(\n          `http://localhost:5001/api/auth${endpoint}`,\n          inputs\n        );\n\n        console.log(isRegister ? \"Registration successful\" : \"Login successful\", response.data);\n        resetForm(initialState);\n\n        if (!isRegister) {\n          localStorage.setItem('token', response.data.token);\n          login(response.data.user.name);\n          navigate('/'); // Redirect to home or dashboard\n        }\n      } catch (error: any) {\n        setError(error.response?.data?.error || 'Something went wrong');\n        console.error('Auth error:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    } else {\n      console.log(\"Validation failed:\", errors);\n    }\n  };\n\n  return { inputs, errors, handleChange, isLoading, error, handleSubmit };\n};\n\nexport default useAuth;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}